#include "FastLED.h" 
#include <SPI.h>

///設定pin
#define LP_PIN 13
#define RP_PIN 14
#define LC_PIN 10
#define RC_PIN 11
#define CD_PIN 9
//設定數量
#define LP_NUM 7    
#define RP_NUM 7
#define LC_NUM 8
#define RC_NUM 9
#define CD_NUM 2

#define LED_TYPE WS2812 
#define COLOR_ORDER GRB
#define T_LEN 119//陣列數
#define LEN 6  // 不位數
//顏色陣列
CRGB color[] = {CRGB::Black, CRGB::Red, CRGB::Orange, CRGB::Yellow, CRGB::Green, CRGB::Blue, CRGB::Purple};
/// 輸入矩陣
byte A[T_LEN][LEN]= {{0,0,0,1,1,0}, {0,0,0,0,0,4}, {0,0,0,0,0,0}, {0,0,0,0,0,4}, {0,0,0,0,0,0}, {0,0,0,0,0,4}, {0,0,0,0,0,0}, {1,6,0,1,1,0}, {0,0,2,0,0,0}, {0,0,0,0,0,0}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {0,0,0,0,0,4}, {1,6,2,1,1,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {1,6,0,1,1,0}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,2,0,0,0}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,4}, {0,6,0,0,0,0}, {1,0,0,1,1,0}, {0,0,2,0,0,0}, {1,6,2,1,1,4}, {0,0,2,0,0,0}, {1,0,0,1,1,0}, {0,6,0,0,0,0}, {0,0,0,0,0,4}, {1,6,2,1,1,4}, {0,0,0,0,0,4}, {0,6,0,0,0,0}, {1,0,0,1,1,0}, {0,0,2,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,4}, {0,6,0,0,0,0}, {1,0,0,1,1,0}, {0,0,2,0,0,0}, {0,0,0,0,0,4}, {0,6,0,0,0,0}, {1,0,0,1,1,0}, {0,0,2,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}, {0,0,0,0,0,0}, {1,6,2,1,1,4}};
int time[T_LEN] = {0, 8213, 8985, 11684, 11823, 11944, 12065, 13560, 14147, 14480, 16587, 16722, 33440, 45925, 50447, 51959, 52610, 56254, 60854, 61094, 61335, 61576, 61817, 62058, 62299, 62540, 62781, 63022, 63263, 63504, 63746, 63987, 64227, 64468, 65086, 74954, 75094, 75233, 75371, 75510, 75655, 83185, 83330, 83475, 83620, 83765, 85195, 85336, 85478, 85620, 85762, 85904, 87307, 87438, 87569, 87700, 87831, 87962, 89428, 89542, 89658, 89772, 90484, 95100, 95428, 102481, 102744, 104400, 111100, 111260, 111900, 125963, 126086, 126209, 126332, 126455, 129823, 130003, 130183, 130363, 130543, 133803, 133980, 134157, 134334, 134511, 136320, 144300, 147572, 152568, 160338, 160472, 160606, 160741, 160876, 161060, 161244, 161428, 161828, 163851, 164297, 166190, 166750, 172425, 174894, 178358, 179520, 191620, 194700, 201086, 201727, 202300, 203000, 210836, 212652, 222628, 224895, 232786, 236522};
uint8_t max_bright = 255;
int lst_time = 0;

//建立燈帶
CRGB lps[LP_NUM]; 
CRGB rps[RP_NUM];
CRGB lcs[LC_NUM];
CRGB rcs[RC_NUM];
CRGB cds[CD_NUM];
void setup() {
   pinMode(7, INPUT);

   Serial.begin(115200);
   //初始化燈帶
   LEDS.addLeds<LED_TYPE, LP_PIN, COLOR_ORDER>(lps, LP_NUM);
   LEDS.addLeds<LED_TYPE, RP_PIN, COLOR_ORDER>(rps, RP_NUM); 
   LEDS.addLeds<LED_TYPE, LC_PIN, COLOR_ORDER>(lcs, LC_NUM);
   LEDS.addLeds<LED_TYPE, RC_PIN, COLOR_ORDER>(rcs, RC_NUM);
   LEDS.addLeds<LED_TYPE, CD_PIN, COLOR_ORDER>(cds, CD_NUM);
   FastLED.setBrightness(max_bright);
   //關燈
   fill_solid(lps,LP_NUM,CRGB::Black);
   fill_solid(rps,RP_NUM,CRGB::Black);
   fill_solid(lcs,LC_NUM,CRGB::Black);
   fill_solid(rcs,RC_NUM,CRGB::Black);
   fill_solid(cds,CD_NUM,CRGB::Black);
   FastLED.show();
}

void loop() {
   int signalValue = digitalRead(7);
   if (signalValue==1){ 
   for(int i = 0;i<T_LEN;i++){
      int Time = A[i][0];
      int Delay = Time - lst_time;
      delay(Delay);
      //改變燈
      //改變下衣服
      fill_solid(cds, CD_NUM, color[A[i][1]]);
      
      //改變衣服
      fill_solid(lcs, LC_NUM, color[A[i][0]]);
      fill_solid(rcs, RC_NUM, color[A[i][0]]);
      
      //改變褲子
      fill_solid(lps, LP_NUM, color[A[i][5]]);
      fill_solid(rps, RP_NUM, color[A[i][5]]);
   
      lst_time = Time;
      //顯示
      FastLED.show();
      }}
}
